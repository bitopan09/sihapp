<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>CalmQuest2D</title>
  <script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.js"></script>
  <style>
    body { margin: 0; padding: 0; background: #222; }
    canvas { display: block; margin: auto; }
  </style>
</head>
<body>
<script>
var config = {
    type: Phaser.AUTO,
    scale: {
        mode: Phaser.Scale.FIT,
        autoCenter: Phaser.Scale.CENTER_BOTH,
        width: 800,
        height: 600
    },
    backgroundColor: "#ffffff",
    scene: [MainMenu, EmotionGame]
};

var game = new Phaser.Game(config);

// --- Main Menu Scene ---
class MainMenu extends Phaser.Scene {
    constructor() { super({ key: 'MainMenu' }); }
    create() {
        this.add.text(400, 150, 'CalmQuest2D', { fontSize: '48px', color: '#000' }).setOrigin(0.5);

        const btn = this.add.text(400, 300, 'üòä Emotion Game', { fontSize: '32px', color: '#000', backgroundColor: '#ddd' })
            .setOrigin(0.5).setInteractive();
        btn.on('pointerdown', () => this.scene.start('EmotionGame'));
    }
}

// --- Emotion Game Scene ---
class EmotionGame extends Phaser.Scene {
    constructor() { super({ key: 'EmotionGame' }); }
    create() {
        this.emotions = [
            {emoji: 'üòä', name: 'Happy'},
            {emoji: 'üò¢', name: 'Sad'},
            {emoji: 'üò°', name: 'Angry'},
            {emoji: 'üòå', name: 'Calm'}
        ];
        this.correctEmotion = {};
        this.buttons = [];

        this.emotionIcon = this.add.text(400, 200, '', { fontSize: '100px' }).setOrigin(0.5);

        for (let i=0; i<3; i++) {
            let btn = this.add.text(200+i*200, 400, '', {
                fontSize:'28px',
                color:'#000',
                backgroundColor:'#eee',
                padding:{x:10,y:5}
            }).setOrigin(0.5).setInteractive();

            btn.on('pointerdown', () => this.checkAnswer(btn.text));
            this.buttons.push(btn);
        }

        this.statusLabel = this.add.text(400, 520, '', {fontSize:'24px', color:'#000'}).setOrigin(0.5);
        this.newRound();
    }

    newRound() {
        Phaser.Utils.Array.Shuffle(this.emotions);
        this.correctEmotion = this.emotions[0];
        this.emotionIcon.setText(this.correctEmotion.emoji);

        let options = this.emotions.slice(0,3);
        Phaser.Utils.Array.Shuffle(options);
        for (let i=0;i<3;i++) this.buttons[i].setText(options[i].name);

        this.statusLabel.setText('Identify the emotion shown');
    }

    checkAnswer(selected) {
        if (selected === this.correctEmotion.name) {
            this.statusLabel.setText('‚úÖ Correct!');
            this.time.delayedCall(1000, () => this.newRound());
        } else {
            this.statusLabel.setText('‚ùå Try again!');
        }
    }
}
</script>
</body>
</html>
